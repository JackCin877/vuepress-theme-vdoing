(window.webpackJsonp=window.webpackJsonp||[]).push([[95],{422:function(t,s,a){"use strict";a.r(s);var n=a(3),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"定时器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#定时器"}},[t._v("#")]),t._v(" 定时器")]),t._v(" "),s("h3",{attrs:{id:"_1、定时器的基本概念"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1、定时器的基本概念"}},[t._v("#")]),t._v(" 1、定时器的基本概念")]),t._v(" "),s("p",[t._v("（对于51单片机的定时器看来几篇博客，写的和详细，所以就没再自己详细写，感谢大佬们的分享🌼🌷🌹）")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://qrschenze.blog.csdn.net/article/details/121110441",target:"_blank",rel:"noopener noreferrer"}},[t._v("(13条消息) 【51单片机】十分钟学会定时器&中断¹_51单片机定时器_謓泽的博客-CSDN博客"),s("OutboundLink")],1)]),t._v(" "),s("p",[s("a",{attrs:{href:"https://qrschenze.blog.csdn.net/article/details/121205540",target:"_blank",rel:"noopener noreferrer"}},[t._v("(13条消息) 【51单片机】配置定时器_定时器里面的t0count是什么_謓泽的博客-CSDN博客"),s("OutboundLink")],1)]),t._v(" "),s("p",[s("a",{attrs:{href:"https://blog.csdn.net/weixin_66578482/article/details/124806267?ops_request_misc=&request_id=d22aae57e44f4718820795b152a4c01d&biz_id=&utm_medium=distribute.pc_search_result.none-task-blog-2~blog~koosearch~default-2-124806267-null-null.268%5Ev1%5Econtrol&utm_term=%E5%AE%9A%E6%97%B6%E5%99%A8&spm=1018.2226.3001.4450",target:"_blank",rel:"noopener noreferrer"}},[t._v("（六）51单片机基础——定时器_单片机定时器_花园宝宝小点点的博客-CSDN博客"),s("OutboundLink")],1)]),t._v(" "),s("h3",{attrs:{id:"_2、初识化定时器函数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2、初识化定时器函数"}},[t._v("#")]),t._v(" 2、初识化定时器函数")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://img-blog.csdnimg.cn/b5c5edcc621745a5b9e9d1c8c389c156.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5rO95aWA,size_20,color_FFFFFF,t_70,g_se,x_16",alt:"img"}})]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("GATE 连接的是非门")]),t._v("（即为取反，就是0变为1，1变为0）")]),t._v(" "),s("li",[s("strong",[t._v("——INTO连接的是或门")]),t._v("（有1为1，全0为0）")]),t._v(" "),s("li",[s("strong",[t._v("TR0连接的是与门")]),t._v("（全1为1，其余为0）")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://img-blog.csdnimg.cn/2d6c9b6c6a26464799ae68144e4f9e55.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5rO95aWA,size_20,color_FFFFFF,t_70,g_se,x_16",alt:"img"}})]),t._v(" "),s("p",[s("img",{attrs:{src:"https://img-blog.csdnimg.cn/bd99b5b06c484669bf4f694100033c18.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5rO95aWA,size_20,color_FFFFFF,t_70,g_se,x_16",alt:"img"}})]),t._v(" "),s("ul",[s("li",[t._v("步骤\n"),s("ul",[s("li",[s("ol",[s("li",[t._v("先配置TMOD（定时器模式）和TCON（定时器控制寄存器）")])])]),t._v(" "),s("li",[s("ol",{attrs:{start:"2"}},[s("li",[t._v("设置定时初值")])])]),t._v(" "),s("li",[s("ol",{attrs:{start:"3"}},[s("li",[t._v("配置中断寄存器")])])])])])]),t._v(" "),s("div",{staticClass:"language-c line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Timer0Init")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//配置定时器模式（TMOD）")]),t._v("\n\tTMOD"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0xF0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//把TMOD的低四位清零，高四位保持不变")]),t._v("\n\tTMOD"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0x01")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//把TMOD的高四位保持不变，最低位置为1")]),t._v("\n\t\n\t\n\tTL0 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0x18")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//设置定时初值")]),t._v("\n\tTH0 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0xFC")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//设置定时初值")]),t._v("\n\t\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//配置定时器控制寄存器（TCON）")]),t._v("\n\tTF0 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//清除TF0标志")]),t._v("\n\tTR0 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//定时器0开始计时")]),t._v("\n\t\n\t\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//配置中断寄存器")]),t._v("\n\tET0"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n\tEA"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\tPT0"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br")])]),s("h3",{attrs:{id:"_3、定时器中断处理函数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3、定时器中断处理函数"}},[t._v("#")]),t._v(" 3、定时器中断处理函数")]),t._v(" "),s("div",{staticClass:"language-c line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//基础模板")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Timer0_Routine")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" interrupt "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("unsigned")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" T0Count"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\tTL0 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0x18")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//设置定时初值")]),t._v("\n\tTH0 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0xFC")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//设置定时初值")]),t._v("\n\tT0Count"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//T0Count计次，对中断频率进行分频")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("T0Count"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("500")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//分频500次，500ms")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\tT0Count"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//if(LEDMode==0)\t\t\t//模式判断")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//\tP2=_crol_(P2,1);\t//LED输出")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//if(LEDMode==1)")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//\tP2=_cror_(P2,1);")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br")])]),s("ul",[s("li",[s("strong",[t._v("中断函数注意要重新赋定时初值")])]),t._v(" "),s("li",[t._v("我们"),s("strong",[t._v("上面创建的定时函数是1ms溢出一次")]),t._v("，即执行一次中断函数，所以要每0.5s进行一次操作，需要有个变量 T0Count 里进行计数")])]),t._v(" "),s("h3",{attrs:{id:"_4、循环移位函数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4、循环移位函数"}},[t._v("#")]),t._v(" 4、循环移位函数")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("#include <"),s("strong",[t._v("INTRINS.H")]),t._v(">函数库里有")])]),t._v(" "),s("li",[s("p",[t._v("_cror_(unsigned char,unsigned char);  "),s("strong",[t._v("循环右移函数")])])]),t._v(" "),s("li",[s("p",[t._v("_crol_(unsigned char,unsigned char);  "),s("strong",[t._v("循环左移函数")])]),t._v(" "),s("div",{staticClass:"language-c line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[t._v("P2"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0xFE")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//1111 1110")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//P2=_crol_(P2,1);  //P2= 1111 1101")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//即是8位数在首尾循环，不会出现越界问题")]),t._v("\nP2"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("_crol_")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("P2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//P2= 1111 1110")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])])])]),t._v(" "),s("p",[t._v("补充："),s("strong",[s("font",{attrs:{color:"blue"}},[t._v("我们上面使用的是16位定时器，16位定时器的计数比较多，但是每次需要我们自己重新赋初值，而8位的就是将16位分开，一个计数，一个存放初值，每次计数完成后，AR会自动将初值给CNT,不用我们自己代码赋初值，比较快，但是计数范围小")])],1)]),t._v(" "),s("p",[s("img",{attrs:{src:"https://jackcin877.github.io/image-hosting/51MUC/%E5%AE%9A%E6%97%B6%E5%99%A8/%E8%AE%A1%E6%95%B0%E5%99%A8.i0eh6sexef4.webp",alt:"计数器"}})])])}),[],!1,null,null,null);s.default=e.exports}}]);